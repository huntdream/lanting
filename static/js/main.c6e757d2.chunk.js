(this.webpackJsonplanting=this.webpackJsonplanting||[]).push([[0],{171:function(e,t,n){e.exports=n.p+"static/media/bg.f0ef5918.jpg"},180:function(e,t,n){e.exports=n(343)},209:function(e,t,n){},210:function(e,t,n){},211:function(e,t,n){},212:function(e,t,n){},217:function(e,t,n){},313:function(e,t,n){},315:function(e,t,n){},316:function(e,t,n){},317:function(e,t,n){},318:function(e,t,n){},335:function(e,t,n){},336:function(e,t,n){},337:function(e,t,n){},338:function(e,t,n){},340:function(e,t,n){},341:function(e,t,n){},342:function(e,t,n){},343:function(e,t,n){"use strict";n.r(t);var a=n(0),l=n.n(a),r=n(86),c=n.n(r),o=n(11),i=(n(209),n(17)),s=n(39),u=n(6),m=n(15),d=n.n(m),g=(n(210),n(32)),f=(n(211),function(e){var t=e.className,n=e.children,a=e.style,r=e.onClick,c=Object(g.a)(e,["className","children","style","onClick"]);return l.a.createElement("i",Object.assign({className:d()("material-icons",r?"lanting-icon--clickable":void 0,t),onClick:r,style:a},c),n)}),b=Object(o.atom)({key:"theme",default:localStorage.getItem("theme")||"light"}),h=(n(212),function(){var e=Object(o.useRecoilState)(b),t=Object(i.a)(e,2),n=t[0],a=t[1];return l.a.createElement("div",{className:"lanting-themetoggle",onClick:function(){a("dark"===n?"light":"dark")}},"dark"===n?"\ud83c\udf19":"\u2600\ufe0f")}),p=function(){var e=Object(u.g)().pathname,t=Object(a.useMemo)((function(){return"/edit"===e}),[e]);return l.a.createElement("div",{className:d()("lanting-nav")},l.a.createElement("div",{className:"lanting-nav-inner"},l.a.createElement("div",{className:"lanting-nav-title"},l.a.createElement(s.b,{to:"/",className:"lanting-nav-link"},l.a.createElement("h2",{className:"lanting-nav-name"},"\u5170\u4ead")),l.a.createElement("div",{className:"lanting-nav-bio"},"\u6d41\u89de\u66f2\u6c34")),!t&&l.a.createElement(s.b,{className:"lanting-nav-edit",to:"/edit"},l.a.createElement(f,null,"edit")),l.a.createElement(h,null)))},v=(n(217),n(3)),E=n.n(v),y=n(54),S=n.n(y),j=(n(312),n(85),function(e){var t=e.active,n=e.className,a=e.label,r=e.onToggle;return l.a.createElement("div",{onMouseDown:function(e){e.preventDefault(),r()},className:d()("stylecontrols-button",{"stylecontrols-button--active":t},n)},a)}),k=n(171),O=n.n(k),C=[{label:"H1",style:"header-one"},{label:"H2",style:"header-two"},{label:"H3",style:"header-three"},{label:l.a.createElement(f,null,"format_quote"),style:"blockquote"},{label:l.a.createElement(f,null,"format_list_bulleted"),style:"unordered-list-item"},{label:l.a.createElement(f,null,"format_list_numbered"),style:"ordered-list-item"},{label:l.a.createElement(f,null,"code"),style:"code-block"},{label:l.a.createElement(f,null,"image"),style:"image"}],N=function(e){var t=e.editorState,n=e.onChange,a=t.getSelection(),r=t.getCurrentContent().getBlockForKey(a.getStartKey()).getType(),c=function(){var e=t.getSelection(),a=t.getCurrentContent().createEntity("PHOTO","MUTABLE",{src:O.a}),l=a.getLastCreatedEntityKey(),r=v.Modifier.applyEntity(a,e,l),c=v.EditorState.push(t,r,"apply-entity");n(v.AtomicBlockUtils.insertAtomicBlock(c,l," "))};return l.a.createElement(l.a.Fragment,null,C.map((function(e){var a=e.label,o=e.style;return l.a.createElement(j,{active:o===r,className:"stylecontrols-".concat(o.toLowerCase()),key:o,label:a,onToggle:function(){return function(e){"image"===e?c():n(v.RichUtils.toggleBlockType(t,e))}(o)}})})))},w=[{label:l.a.createElement(f,null,"format_bold"),style:"BOLD"},{label:l.a.createElement(f,null,"format_italic"),style:"ITALIC"},{label:l.a.createElement(f,null,"format_underline"),style:"UNDERLINE"},{label:l.a.createElement(f,null,"format_strikethrough"),style:"STRIKETHROUGH"}],x=function(e){var t=e.editorState,n=e.onChange,a=t.getCurrentInlineStyle();return l.a.createElement(l.a.Fragment,null,w.map((function(e){var r=e.label,c=e.style;return l.a.createElement(j,{active:a.has(c),key:c,label:r,onToggle:function(){return e=c,void n(v.RichUtils.toggleInlineStyle(t,e));var e}})})))},T=function(e){var t=e.editorState,n=e.onChange;return l.a.createElement("div",{className:"stylecontrols"},l.a.createElement(x,{editorState:t,onChange:n}),l.a.createElement(N,{editorState:t,onChange:n}))},R=n(88),B=n(89),L=n(1),F=n.n(L);var I=new(function(){function e(){Object(R.a)(this,e),this.highlighted={}}return Object(B.a)(e,[{key:"getDecorations",value:function(e,t){var n,a,l=this,r=0,c=0,o=e.getType(),i=e.getText(),s=e.getKey(),u=Array(i.length).fill(null);if(!["code-block"].includes(o))return F.a.List(u);var m=null===(n=document.querySelector("code[data-offset-key*='".concat(s,"']")))||void 0===n||null===(a=n.closest("pre[class*=language-]"))||void 0===a?void 0:a.className,d=m?/(?<=language-)\w+$/.exec(m):["javascript"],g=S.a.tokenize(i,function(e){return e&&S.a.languages[e]?S.a.languages[e]:S.a.languages.javascript}(d?d[0]:""));this.highlighted[s]={};for(var f=function e(t,n,a){if("string"!==typeof n){var r="tk"+c++,o=s+"-"+r;l.highlighted[s][r]=n,function(e,t,n,a){for(var l=t;l<n;l++)e[l]=a}(t,a,a+n.length,o);for(var i=a,u=0;u<n.content.length;u++){var m=n.content[u];e(t,m,i),i+=m.length}}},b=0;b<g.length;b++){var h=g[b];f(u,h,r),r+=h.length}return F.a.List(u)}},{key:"getComponentForKey",value:function(e){return function(e){return l.a.createElement("span",{className:"token ".concat(e.type)},e.children)}}},{key:"getPropsForKey",value:function(e){var t=e.split("-"),n=Object(i.a)(t,2),a=n[0],l=n[1];return{type:this.highlighted[a][l].type}}}]),e}()),M=(n(313),[{label:"Javascript",syntax:"javascript"},{label:"CSS",syntax:"css"},{label:"HTML",syntax:"html"},{label:"Golang",syntax:"golang"},{label:"C",syntax:"c"},{label:"C++",syntax:"cpp"},{label:"Bash",syntax:"bas"},{label:"Java",syntax:"java"},{label:"Typescript",syntax:"ts"},{label:"React JSX ",syntax:"jsx"},{label:"React TSX",syntax:"tsx"},{label:"Git",syntax:"git"},{label:"Json",syntax:"json"}]),K=function(e){var t=e.children,n=Object(g.a)(e,["children"]),r=Object(a.useState)("javascript"),c=Object(i.a)(r,2),o=c[0],s=c[1];return l.a.createElement("div",{className:"prismjscode"},l.a.createElement("div",{className:"prismjscode-header",contentEditable:!1},l.a.createElement("select",{className:"prismjscode-switch",value:o,onChange:function(e){s(e.target.value)}},M.map((function(e){return l.a.createElement("option",{value:e.syntax,key:e.syntax},e.label)}))),l.a.createElement(f,null,"description")),l.a.createElement("pre",{className:"language-".concat(o)},l.a.createElement("code",n,t)))},D=Object(L.Map)({"code-block":{wrapper:l.a.createElement(K,null)}}),U=v.DefaultDraftBlockRenderMap.merge(D),A=function(e){var t=e.getCurrentContent(),n=e.getSelection().getStartKey();return t.getBlockForKey(n)},q=function(e,t){return A(t).getType()===e},_={getCurrentBlock:A,hasSelectionInBlock:q,onTabInCode:function(e,t){e.preventDefault();var n=t.getCurrentContent(),a=t.getSelection(),l=a.getStartKey(),r=(n.getBlockForKey(l).getText(),null);return r=a.isCollapsed()?E.a.Modifier.insertText(n,a,"  "):E.a.Modifier.replaceText(n,a,"  "),E.a.EditorState.push(t,r,"insert-characters")},hidePlaceholder:function(e){var t=e.getCurrentContent();return!t.hasText()&&"unstyled"!==t.getBlockMap().first().getType()},convertToState:function(e){try{var t=JSON.parse(e);return console.log(t),v.EditorState.createWithContent(Object(v.convertFromRaw)(t))}catch(l){var n=Object(v.convertFromHTML)(e),a=v.ContentState.createFromBlockArray(n.contentBlocks,n.entityMap);return v.EditorState.createWithContent(a)}}},H=function(e){return"blockquote"===e.getType()?"myeditor-blockquote":""},P=(n(314),n(315),function(e){var t=e.contentState,n=e.block;console.log(t,n);var a=t.getEntity(n.getEntityAt(0)).getData().src;return l.a.createElement("img",{src:a,alt:"flower",className:"lanting-editor-image"})}),J=function(e){return function(e){return"atomic"===e.getType()?{component:P,editable:!1}:null}},V=(n(316),function(e){var t=e.rawContent,n=e.onChange,r=Object(a.useRef)(null),c=v.EditorState.createEmpty(I),o=Object(a.useState)(!1),s=Object(i.a)(o,1)[0],u=Object(a.useState)(c),m=Object(i.a)(u,2),g=m[0],f=m[1];Object(a.useEffect)((function(){s||b(),S.a.highlightAll()}),[s]),Object(a.useEffect)((function(){t&&f(_.convertToState(t))}),[t]);var b=function(){return r.current&&r.current.focus()},h=function(e){f(e),n&&n(e.getCurrentContent())},p=Object(a.useCallback)((function(){}),[]);return l.a.createElement("div",{className:d()("lanting-editor",{"lanting-editor-hideplaceholder":_.hidePlaceholder(g)}),id:"lanting-editor"},!s&&l.a.createElement(T,{onChange:h,editorState:g}),l.a.createElement(v.Editor,{ref:r,readOnly:s,placeholder:"Your Story",onChange:h,editorState:g,onFocus:function(){document.addEventListener("selectionchange",p)},onBlur:function(){document.removeEventListener("selectionchange",p)},onTab:function(e){_.hasSelectionInBlock("code-block",g)&&h(_.onTabInCode(e,g))},blockRenderMap:U,blockRendererFn:J(g),blockStyleFn:H,handleKeyCommand:function(e,t){var n=v.RichUtils.handleKeyCommand(t,e);return n?(f(n),"handled"):"not-handled"},handleReturn:function(e,t){var n=_.getCurrentBlock(t);return["blockquote","code-block"].includes(n.getType())?(h(v.RichUtils.insertSoftNewline(t)),"handled"):"not-handled"}}))}),z=n(177),G=(n(317),function(e){var t=e.children,n=e.className,a=e.disabled,r=e.style,c=e.color,o=void 0===c?"primary":c,i=Object(g.a)(e,["children","className","disabled","style","color"]);return l.a.createElement("button",Object.assign({},i,{className:d()("lanting-button","lanting-button--".concat(o),{"lanting-button--disabled":a},n),style:r,disabled:a}),t)}),W=(n(318),Object(a.forwardRef)((function(e,t){var n=e.className,a=Object(g.a)(e,["className"]);return l.a.createElement("input",Object.assign({ref:t,className:d()("lanting-input",n)},a))}))),X=n(172),Y=n.n(X),$={baseurl:"http://localhost:4000/api/v1"},Q=n(18),Z=Object(Q.a)(),ee=Y.a.create({baseURL:$.baseurl}),te=["/auth/signin","/auth/signup"];ee.interceptors.request.use((function(e){var t=localStorage.getItem("lanting-token");return t&&e.url&&!te.includes(e.url)&&(e.headers.Authorization="Bearer "+t),e})),ee.interceptors.response.use((function(e){return e.data}),(function(e){var t,n;return console.log(e.response),401===(null===e||void 0===e||null===(t=e.response)||void 0===t?void 0:t.status)&&Z.push("/signin"),Promise.reject(null===e||void 0===e||null===(n=e.response)||void 0===n?void 0:n.data)}));var ne=ee,ae=function(){var e=Object(a.useState)(""),t=Object(i.a)(e,2),n=t[0],r=t[1],c=Object(a.useState)(""),o=Object(i.a)(c,2),s=o[0],u=o[1];return l.a.createElement("div",{className:"lanting-edit"},l.a.createElement("div",{className:"lanting-edit-header"},l.a.createElement("div",null,l.a.createElement(W,{placeholder:"Title",value:n,onChange:function(e){var t=e.target.value;return r(t)}})),l.a.createElement(G,{onClick:function(){console.log("publishing"),ne.post("article",{title:n,content:s})}},"Publish")),l.a.createElement(V,{onChange:function(e){var t=Object(z.a)(e);console.log(t),u(t)}}))},le=(n(335),n(336),function(e){e.id;var t=e.title,n=e.content;return l.a.createElement("article",{className:"lanting-post"},l.a.createElement("header",{className:"lanting-post-header"},l.a.createElement("h3",{className:"lanting-post-title"},t)),l.a.createElement("main",{className:"lanting-post-content"},n),l.a.createElement("footer",{className:"lanting-post-footer"}))}),re=n(87),ce=n.n(re),oe=n(173),ie=Object(o.atom)({key:"article",default:{data:[],count:0,total:0}}),se=Object(o.selectorFamily)({key:"ArticleList",get:function(e){return function(){var t=Object(oe.a)(ce.a.mark((function t(n){var a,l;return ce.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a=n.get,t.next=3,ne.get("/article",{params:e}).catch((function(){return a(ie)}));case 3:return l=t.sent,t.abrupt("return",l);case 5:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()}}),ue=(n(337),function(){var e=Object(o.useRecoilValue)(se({size:20}));return console.log(e),l.a.createElement("div",null,e.data.map((function(e){return l.a.createElement(le,Object.assign({key:e.id},e))})))}),me=function(){return l.a.createElement("div",{className:"index"},l.a.createElement(p,null),l.a.createElement(a.Suspense,{fallback:l.a.createElement("div",null,"Loading")},l.a.createElement(u.c,null,l.a.createElement(u.a,{path:"/",exact:!0,component:ue}),l.a.createElement(u.a,{path:"/edit",component:ae}))))},de=(n(338),n(98)),ge=n(67),fe=(n(340),function(){var e=Object(a.useMemo)((function(){return{username:"",password:""}}),[]);return l.a.createElement("div",{className:"lanting-signup"},l.a.createElement(ge.b,{onSubmit:function(e,t){var n=t.setSubmitting;console.log(e),ne.post("/auth/signup",Object(de.a)({},e)).finally((function(){n(!1)}))},initialValues:e},(function(e){var t=e.values,n=e.handleChange,a=e.handleSubmit,r=e.isSubmitting;return l.a.createElement(ge.a,{onSubmit:a},l.a.createElement("div",{className:"lanting-signup-username"},l.a.createElement("label",{htmlFor:"username"},"Username"),l.a.createElement(W,{autoComplete:"off",name:"username",id:"username",value:t.username,onChange:n})),l.a.createElement("div",{className:"lanting-signup-password"},l.a.createElement("label",{htmlFor:"password"},"Password"),l.a.createElement(W,{autoComplete:"off",name:"password",id:"password",value:t.password,onChange:n})),l.a.createElement("div",null,l.a.createElement(G,{type:"submit",disabled:r},"Submit")))})))}),be=(n(341),Object(o.atom)({key:"user",default:null})),he=n(102),pe=(n(342),{Error:function(e){var t=e.className,n=e.children;return l.a.createElement("div",{className:d()("lanting-text lanting-text--error",t)},n)}}),ve=he.a().shape({username:he.b().min(5,"Sorry, your username must be between 6 and 16 characters long.").max(16,"Sorry, your username must be between 6 and 16 characters long.").required(),password:he.b().min(5,"Sorry, your username must be between 6 and 16 characters long.").max(16,"Sorry, your username must be between 6 and 16 characters long.").required()}),Ee=function(){var e=Object(o.useSetRecoilState)(be),t=Object(u.f)(),n=Object(a.useMemo)((function(){return{username:"",password:""}}),[]);return l.a.createElement("div",{className:"lanting-signin"},l.a.createElement(ge.b,{validationSchema:ve,onSubmit:function(n,a){var l=a.setSubmitting;console.log(n),ne.post("/auth/signin",Object(de.a)({},n)).then((function(n){var a=n.token,l=Object(g.a)(n,["token"]);e(l),localStorage.setItem("lanting-token",a),t.replace("/")})).finally((function(){l(!1)}))},initialValues:n},(function(e){var t=e.values,n=e.errors,a=e.handleChange,r=e.handleSubmit,c=e.isSubmitting,o=e.isValid;return l.a.createElement(ge.a,{onSubmit:r,className:"lanting-signin-form"},l.a.createElement("div",{className:"lanting-signin-username"},l.a.createElement("label",{htmlFor:"username"},"Username"),l.a.createElement(W,{autoComplete:"off",name:"username",id:"username",value:t.username,onChange:a}),l.a.createElement(pe.Error,null,n.username)),l.a.createElement("div",{className:"lanting-signin-password"},l.a.createElement("label",{htmlFor:"password"},"Password"),l.a.createElement(W,{type:"password",autoComplete:"off",name:"password",id:"password",value:t.password,onChange:a}),l.a.createElement(pe.Error,null,n.password)),l.a.createElement("div",{className:"lanting-signin-submit"},l.a.createElement(s.b,{to:"/signup",style:{textDecoration:"none"}},"Create account"),l.a.createElement(G,{type:"submit",disabled:c||!o},"Sign In")))})))},ye=n(179),Se=n(178),je=function(e){Object(ye.a)(n,e);var t=Object(Se.a)(n);function n(){return Object(R.a)(this,n),t.apply(this,arguments)}return Object(B.a)(n,[{key:"componentDidCatch",value:function(e,t){console.log(e,t)}},{key:"render",value:function(){return this.props.children}}],[{key:"getDerivedStateFromError",value:function(){return"Error"}}]),n}(l.a.Component);var ke=function(){var e=Object(o.useRecoilState)(b),t=Object(i.a)(e,2),n=t[0],r=t[1];return Object(a.useEffect)((function(){var e=localStorage.getItem("theme")||"light";r(e),document.body.classList.add("theme-fade")}),[r]),Object(a.useEffect)((function(){"light"===n?(document.documentElement.classList.remove("dark"),document.documentElement.classList.add("light")):(document.documentElement.classList.remove("light"),document.documentElement.classList.add("dark")),localStorage.setItem("theme",n)}),[n]),l.a.createElement(je,null,l.a.createElement(s.a,null,l.a.createElement("div",{className:"app"},l.a.createElement(u.c,null,l.a.createElement(u.a,{path:"/signup",exact:!0,component:fe}),l.a.createElement(u.a,{path:"/signin",exact:!0,component:Ee}),l.a.createElement(u.a,{path:"/",component:me})))))};c.a.render(l.a.createElement(l.a.StrictMode,null,l.a.createElement(o.RecoilRoot,null,l.a.createElement(ke,null))),document.getElementById("root"))},85:function(e,t,n){}},[[180,1,2]]]);
//# sourceMappingURL=main.c6e757d2.chunk.js.map