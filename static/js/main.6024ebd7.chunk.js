(this.webpackJsonplanting=this.webpackJsonplanting||[]).push([[0],{129:function(e,t,n){e.exports=n.p+"static/media/bg.f0ef5918.jpg"},137:function(e,t,n){e.exports=n(298)},166:function(e,t,n){},167:function(e,t,n){},168:function(e,t,n){},173:function(e,t,n){},269:function(e,t,n){},271:function(e,t,n){},272:function(e,t,n){},273:function(e,t,n){},274:function(e,t,n){},275:function(e,t,n){},292:function(e,t,n){},293:function(e,t,n){},295:function(e,t,n){},296:function(e,t,n){},297:function(e,t,n){},298:function(e,t,n){"use strict";n.r(t);var a=n(0),l=n.n(a),r=n(54),c=n.n(r),o=n(8),i=(n(166),n(20)),s=n(33),u=n(5),m=n(19),d=n.n(m),g=(n(167),n(22)),f=(n(168),function(e){var t=e.className,n=e.children,a=e.style,r=e.onClick,c=Object(g.a)(e,["className","children","style","onClick"]);return l.a.createElement("i",Object.assign({className:d()("material-icons",r?"lanting-icon--clickable":void 0,t),onClick:r,style:a},c),n)}),b=Object(o.atom)({key:"theme",default:localStorage.getItem("theme")||"light"}),h=function(){var e=Object(o.useRecoilState)(b),t=Object(i.a)(e,2),n=t[0],r=t[1],c=Object(u.g)().pathname,m=Object(a.useMemo)((function(){return"/edit"===c}),[c]);return l.a.createElement("div",{className:d()("lanting-nav")},l.a.createElement("div",{className:"lanting-nav-inner"},l.a.createElement("div",{className:"lanting-nav-title"},l.a.createElement(s.b,{to:"/",className:"lanting-nav-link"},l.a.createElement("h2",{className:"lanting-nav-name"},"\u5170\u4ead")),l.a.createElement("div",{className:"lanting-nav-bio"},"\u6d41\u89de\u66f2\u6c34")),!m&&l.a.createElement(s.b,{className:"lanting-nav-edit",to:"/edit"},l.a.createElement(f,null,"edit")),l.a.createElement("span",{onClick:function(){r("dark"===n?"light":"dark")},className:"lanting-nav-theme"},"dark"===n?"\ud83c\udf19":"\u2600\ufe0f")))},p=(n(173),n(3)),v=n.n(p),E=n(35),y=n.n(E),k=(n(268),n(53),function(e){var t=e.active,n=e.className,a=e.label,r=e.onToggle;return l.a.createElement("div",{onMouseDown:function(e){e.preventDefault(),r()},className:d()("stylecontrols-button",{"stylecontrols-button--active":t},n)},a)}),j=n(129),S=n.n(j),C=[{label:"H1",style:"header-one"},{label:"H2",style:"header-two"},{label:"H3",style:"header-three"},{label:l.a.createElement(f,null,"format_quote"),style:"blockquote"},{label:l.a.createElement(f,null,"format_list_bulleted"),style:"unordered-list-item"},{label:l.a.createElement(f,null,"format_list_numbered"),style:"ordered-list-item"},{label:l.a.createElement(f,null,"code"),style:"code-block"},{label:l.a.createElement(f,null,"image"),style:"image"}],O=function(e){var t=e.editorState,n=e.onChange,a=t.getSelection(),r=t.getCurrentContent().getBlockForKey(a.getStartKey()).getType(),c=function(){var e=t.getSelection(),a=t.getCurrentContent().createEntity("PHOTO","MUTABLE",{src:S.a}),l=a.getLastCreatedEntityKey(),r=p.Modifier.applyEntity(a,e,l),c=p.EditorState.push(t,r,"apply-entity");n(p.AtomicBlockUtils.insertAtomicBlock(c,l," "))};return l.a.createElement(l.a.Fragment,null,C.map((function(e){var a=e.label,o=e.style;return l.a.createElement(k,{active:o===r,className:"stylecontrols-".concat(o.toLowerCase()),key:o,label:a,onToggle:function(){return function(e){"image"===e?c():n(p.RichUtils.toggleBlockType(t,e))}(o)}})})))},N=[{label:l.a.createElement(f,null,"format_bold"),style:"BOLD"},{label:l.a.createElement(f,null,"format_italic"),style:"ITALIC"},{label:l.a.createElement(f,null,"format_underline"),style:"UNDERLINE"},{label:l.a.createElement(f,null,"format_strikethrough"),style:"STRIKETHROUGH"}],x=function(e){var t=e.editorState,n=e.onChange,a=t.getCurrentInlineStyle();return l.a.createElement(l.a.Fragment,null,N.map((function(e){var r=e.label,c=e.style;return l.a.createElement(k,{active:a.has(c),key:c,label:r,onToggle:function(){return e=c,void n(p.RichUtils.toggleInlineStyle(t,e));var e}})})))},w=function(e){var t=e.editorState,n=e.onChange;return l.a.createElement("div",{className:"stylecontrols"},l.a.createElement(x,{editorState:t,onChange:n}),l.a.createElement(O,{editorState:t,onChange:n}))},T=n(56),R=n(57),B=n(1),L=n.n(B);var F=new(function(){function e(){Object(T.a)(this,e),this.highlighted={}}return Object(R.a)(e,[{key:"getDecorations",value:function(e,t){var n,a,l=this,r=0,c=0,o=e.getType(),i=e.getText(),s=e.getKey(),u=Array(i.length).fill(null);if(!["code-block"].includes(o))return L.a.List(u);var m=null===(n=document.querySelector("code[data-offset-key*='".concat(s,"']")))||void 0===n||null===(a=n.closest("pre[class*=language-]"))||void 0===a?void 0:a.className,d=m?/(?<=language-)\w+$/.exec(m):["javascript"],g=y.a.tokenize(i,function(e){return e&&y.a.languages[e]?y.a.languages[e]:y.a.languages.javascript}(d?d[0]:""));this.highlighted[s]={};for(var f=function e(t,n,a){if("string"!==typeof n){var r="tk"+c++,o=s+"-"+r;l.highlighted[s][r]=n,function(e,t,n,a){for(var l=t;l<n;l++)e[l]=a}(t,a,a+n.length,o);for(var i=a,u=0;u<n.content.length;u++){var m=n.content[u];e(t,m,i),i+=m.length}}},b=0;b<g.length;b++){var h=g[b];f(u,h,r),r+=h.length}return L.a.List(u)}},{key:"getComponentForKey",value:function(e){return function(e){return l.a.createElement("span",{className:"token ".concat(e.type)},e.children)}}},{key:"getPropsForKey",value:function(e){var t=e.split("-"),n=Object(i.a)(t,2),a=n[0],l=n[1];return{type:this.highlighted[a][l].type}}}]),e}()),I=(n(269),[{label:"Javascript",syntax:"javascript"},{label:"CSS",syntax:"css"},{label:"HTML",syntax:"html"},{label:"Golang",syntax:"golang"},{label:"C",syntax:"c"},{label:"C++",syntax:"cpp"},{label:"Bash",syntax:"bas"},{label:"Java",syntax:"java"},{label:"Typescript",syntax:"ts"},{label:"React JSX ",syntax:"jsx"},{label:"React TSX",syntax:"tsx"},{label:"Git",syntax:"git"},{label:"Json",syntax:"json"}]),M=function(e){var t=e.children,n=Object(g.a)(e,["children"]),r=Object(a.useState)("javascript"),c=Object(i.a)(r,2),o=c[0],s=c[1];return l.a.createElement("div",{className:"prismjscode"},l.a.createElement("div",{className:"prismjscode-header",contentEditable:!1},l.a.createElement("select",{className:"prismjscode-switch",value:o,onChange:function(e){s(e.target.value)}},I.map((function(e){return l.a.createElement("option",{value:e.syntax,key:e.syntax},e.label)}))),l.a.createElement(f,null,"description")),l.a.createElement("pre",{className:"language-".concat(o)},l.a.createElement("code",n,t)))},K=Object(B.Map)({"code-block":{wrapper:l.a.createElement(M,null)}}),D=p.DefaultDraftBlockRenderMap.merge(K),U=function(e){var t=e.getCurrentContent(),n=e.getSelection().getStartKey();return t.getBlockForKey(n)},A=function(e,t){return U(t).getType()===e},_={getCurrentBlock:U,hasSelectionInBlock:A,onTabInCode:function(e,t){e.preventDefault();var n=t.getCurrentContent(),a=t.getSelection(),l=a.getStartKey(),r=(n.getBlockForKey(l).getText(),null);return r=a.isCollapsed()?v.a.Modifier.insertText(n,a,"  "):v.a.Modifier.replaceText(n,a,"  "),v.a.EditorState.push(t,r,"insert-characters")},hidePlaceholder:function(e){var t=e.getCurrentContent();return!t.hasText()&&"unstyled"!==t.getBlockMap().first().getType()},convertToState:function(e){try{var t=JSON.parse(e);return console.log(t),p.EditorState.createWithContent(Object(p.convertFromRaw)(t))}catch(l){var n=Object(p.convertFromHTML)(e),a=p.ContentState.createFromBlockArray(n.contentBlocks,n.entityMap);return p.EditorState.createWithContent(a)}}},H=function(e){return"blockquote"===e.getType()?"myeditor-blockquote":""},P=(n(270),n(271),function(e){var t=e.contentState,n=e.block;console.log(t,n);var a=t.getEntity(n.getEntityAt(0)).getData().src;return l.a.createElement("img",{src:a,alt:"flower",className:"lanting-editor-image"})}),q=function(e){return function(e){return"atomic"===e.getType()?{component:P,editable:!1}:null}},J=(n(272),function(e){var t=e.rawContent,n=e.onChange,r=Object(a.useRef)(null),c=p.EditorState.createEmpty(F),o=Object(a.useState)(!1),s=Object(i.a)(o,1)[0],u=Object(a.useState)(c),m=Object(i.a)(u,2),g=m[0],f=m[1];Object(a.useEffect)((function(){s||b(),y.a.highlightAll()}),[s]),Object(a.useEffect)((function(){t&&f(_.convertToState(t))}),[t]);var b=function(){return r.current&&r.current.focus()},h=function(e){f(e),n&&n(e.getCurrentContent())},v=Object(a.useCallback)((function(){}),[]);return l.a.createElement("div",{className:d()("lanting-editor",{"lanting-editor-hideplaceholder":_.hidePlaceholder(g)}),id:"lanting-editor"},!s&&l.a.createElement(w,{onChange:h,editorState:g}),l.a.createElement(p.Editor,{ref:r,readOnly:s,placeholder:"Your Story",onChange:h,editorState:g,onFocus:function(){document.addEventListener("selectionchange",v)},onBlur:function(){document.removeEventListener("selectionchange",v)},onTab:function(e){_.hasSelectionInBlock("code-block",g)&&h(_.onTabInCode(e,g))},blockRenderMap:D,blockRendererFn:q(g),blockStyleFn:H,handleKeyCommand:function(e,t){var n=p.RichUtils.handleKeyCommand(t,e);return n?(f(n),"handled"):"not-handled"},handleReturn:function(e,t){var n=_.getCurrentBlock(t);return["blockquote","code-block"].includes(n.getType())?(h(p.RichUtils.insertSoftNewline(t)),"handled"):"not-handled"}}))}),z=n(134),G=(n(273),function(e){var t=e.children,n=e.className,a=e.disabled,r=e.style,c=Object(g.a)(e,["children","className","disabled","style"]);return l.a.createElement("button",Object.assign({},c,{className:d()("lanting-button",n),style:r,disabled:a}),t)}),V=function(){return l.a.createElement("div",{className:"lanting-edit"},l.a.createElement("div",{className:"lanting-edit-header"},l.a.createElement("div",null),l.a.createElement(G,null,"Publish")),l.a.createElement(J,{onChange:function(e){var t=Object(z.a)(e);console.log(t)}}))},W=(n(274),n(275),function(e){e.id;var t=e.title,n=e.content;return l.a.createElement("article",{className:"lanting-post"},l.a.createElement("header",{className:"lanting-post-header"},l.a.createElement("h3",{className:"lanting-post-title"},t)),l.a.createElement("main",{className:"lanting-post-content"},n),l.a.createElement("footer",{className:"lanting-post-footer"}))}),X=n(55),Y=n.n(X),$=n(130),Q=n(131),Z=n.n(Q),ee={baseurl:"http://localhost:4000/api/v1"},te=n(11),ne=Object(te.a)(),ae=Z.a.create({baseURL:ee.baseurl}),le=["/auth/signin","/auth/signup"];ae.interceptors.request.use((function(e){var t=localStorage.getItem("lanting-token");return t&&e.url&&!le.includes(e.url)&&(e.headers.Authorization="Bearer "+t),e})),ae.interceptors.response.use((function(e){return e.data}),(function(e){return console.log(e.response),401===e.response.status&&ne.push("/signin"),Promise.reject(e.response.data)}));var re=ae,ce=Object(o.atom)({key:"article",default:{data:[],count:0,total:0}}),oe=Object(o.selectorFamily)({key:"ArticleList",get:function(e){return function(){var t=Object($.a)(Y.a.mark((function t(n){var a,l;return Y.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a=n.get,t.next=3,re.get("/article",{params:e}).catch((function(){return a(ce)}));case 3:return l=t.sent,t.abrupt("return",l);case 5:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()}}),ie=(n(292),function(){var e=Object(o.useRecoilValue)(oe({size:20,after:60}));return console.log(e),l.a.createElement("div",null,e.data.map((function(e){return l.a.createElement(W,Object.assign({key:e.id},e))})))}),se=function(){return l.a.createElement("div",{className:"index"},l.a.createElement(h,null),l.a.createElement(a.Suspense,{fallback:l.a.createElement("div",null,"Loading")},l.a.createElement(u.c,null,l.a.createElement(u.a,{path:"/",exact:!0,component:ie}),l.a.createElement(u.a,{path:"/edit",component:V}))))},ue=(n(293),n(60)),me=n(36),de=(n(295),Object(a.forwardRef)((function(e,t){var n=e.className,a=Object(g.a)(e,["className"]);return l.a.createElement("input",Object.assign({ref:t,className:d()("lanting-input",n)},a))}))),ge=(n(296),function(){var e=Object(a.useMemo)((function(){return{username:"",password:""}}),[]);return l.a.createElement("div",{className:"lanting-signup"},l.a.createElement(me.b,{onSubmit:function(e,t){var n=t.setSubmitting;console.log(e),re.post("/auth/signup",Object(ue.a)({},e)).finally((function(){n(!1)}))},initialValues:e},(function(e){var t=e.values,n=e.handleChange,a=e.handleSubmit,r=e.isSubmitting;return l.a.createElement(me.a,{onSubmit:a},l.a.createElement("div",{className:"lanting-signup-username"},l.a.createElement("label",{htmlFor:"username"},"Username"),l.a.createElement(de,{autoComplete:"off",name:"username",id:"username",value:t.username,onChange:n})),l.a.createElement("div",{className:"lanting-signup-password"},l.a.createElement("label",{htmlFor:"password"},"Password"),l.a.createElement(de,{autoComplete:"off",name:"password",id:"password",value:t.password,onChange:n})),l.a.createElement("div",null,l.a.createElement("button",{type:"submit",disabled:r},"Submit")))})))}),fe=(n(297),Object(o.atom)({key:"user",default:null})),be=function(){var e=Object(o.useSetRecoilState)(fe),t=Object(u.f)(),n=Object(a.useMemo)((function(){return{username:"",password:""}}),[]);return l.a.createElement("div",{className:"lanting-signin"},l.a.createElement(me.b,{onSubmit:function(n,a){var l=a.setSubmitting;console.log(n),re.post("/auth/signin",Object(ue.a)({},n)).then((function(n){var a=n.token,l=Object(g.a)(n,["token"]);e(l),localStorage.setItem("lanting-token",a),t.replace("/")})).finally((function(){l(!1)}))},initialValues:n},(function(e){var t=e.values,n=e.handleChange,a=e.handleSubmit,r=e.isSubmitting;return l.a.createElement(me.a,{onSubmit:a},l.a.createElement("div",{className:"lanting-signin-username"},l.a.createElement("label",{htmlFor:"username"},"Username"),l.a.createElement(de,{autoComplete:"off",name:"username",id:"username",value:t.username,onChange:n})),l.a.createElement("div",{className:"lanting-signin-password"},l.a.createElement("label",{htmlFor:"password"},"Password"),l.a.createElement(de,{autoComplete:"off",name:"password",id:"password",value:t.password,onChange:n})),l.a.createElement("div",null,l.a.createElement("button",{type:"submit",disabled:r},"Sign In")))})))},he=n(136),pe=n(135),ve=function(e){Object(he.a)(n,e);var t=Object(pe.a)(n);function n(){return Object(T.a)(this,n),t.apply(this,arguments)}return Object(R.a)(n,[{key:"componentDidCatch",value:function(e,t){console.log(e,t)}},{key:"render",value:function(){return this.props.children}}],[{key:"getDerivedStateFromError",value:function(){return"Error"}}]),n}(l.a.Component);var Ee=function(){var e=Object(o.useRecoilState)(b),t=Object(i.a)(e,2),n=t[0],r=t[1];return Object(a.useEffect)((function(){var e=localStorage.getItem("theme")||"light";r(e),document.body.classList.add("theme-fade")}),[r]),Object(a.useEffect)((function(){"light"===n?(document.documentElement.classList.remove("dark"),document.documentElement.classList.add("light")):(document.documentElement.classList.remove("light"),document.documentElement.classList.add("dark")),localStorage.setItem("theme",n)}),[n]),l.a.createElement(ve,null,l.a.createElement(s.a,null,l.a.createElement("div",{className:"app"},l.a.createElement(u.c,null,l.a.createElement(u.a,{path:"/signup",exact:!0,component:ge}),l.a.createElement(u.a,{path:"/signin",exact:!0,component:be}),l.a.createElement(u.a,{path:"/",component:se})))))};c.a.render(l.a.createElement(l.a.StrictMode,null,l.a.createElement(o.RecoilRoot,null,l.a.createElement(Ee,null))),document.getElementById("root"))},53:function(e,t,n){}},[[137,1,2]]]);
//# sourceMappingURL=main.6024ebd7.chunk.js.map