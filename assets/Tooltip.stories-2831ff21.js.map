{"version":3,"file":"Tooltip.stories-2831ff21.js","sources":["../../src/components/Tooltip/Tip.tsx","../../src/components/Tooltip/index.tsx"],"sourcesContent":["import React, { ReactNode, useEffect, useRef, useState } from 'react';\nimport cls from 'classnames';\nimport './style.scss';\n\nexport type Placement = 'top' | 'right' | 'bottom' | 'left';\n\ninterface Props {\n  title: ReactNode;\n  rect: DOMRect;\n  placement?: Placement;\n  isClosing?: boolean;\n  onClose: () => void;\n}\n\nconst Tip: React.FC<Props> = ({\n  title,\n  rect,\n  placement = 'top',\n  isClosing,\n  onClose,\n}) => {\n  const ref = useRef<HTMLDivElement>(null);\n  const [position, setPosition] = useState({ left: 0, top: 0, transform: '' });\n\n  useEffect(() => {\n    const oberver = new ResizeObserver((entries) => {\n      for (const entry of entries) {\n        if (entry.contentRect) {\n          calcPosition();\n        }\n      }\n    });\n\n    if (ref.current) {\n      oberver.observe(ref.current);\n    }\n\n    return () => oberver.disconnect();\n  }, [placement]);\n\n  useEffect(() => {\n    const handleClose = () => {\n      onClose();\n    };\n\n    if (ref.current && isClosing) {\n      ref.current.addEventListener('animationend', handleClose);\n    }\n\n    return () => ref.current?.removeEventListener('animationend', handleClose);\n  }, [isClosing]);\n\n  const calcPosition = () => {\n    if (!ref.current) return;\n    const { width, left, top, height } = rect;\n\n    const coorX = window.scrollX + left;\n    const coorY = window.scrollY + top;\n    const { width: w, height: h } = ref.current.getBoundingClientRect();\n\n    let x = coorX;\n    let y = coorY;\n    let transform = '';\n\n    switch (placement) {\n      case 'right':\n        x = coorX + width;\n        y = coorY + height / 2 - h / 2;\n        // transform = 'translateY(-50%)';\n        break;\n      case 'bottom':\n        x = coorX + width / 2 - w / 2;\n        y = coorY + height;\n        // transform = 'translateX(-50%)';\n\n        break;\n      case 'left':\n        x = coorX - w;\n        y = coorY + height / 2 - h / 2;\n        // transform = 'translate(-100%, -50%)';\n\n        break;\n      default:\n        x = coorX + width / 2 - w / 2;\n        y = coorY - h;\n        // transform = 'translate(-50%, -100%)';\n        break;\n    }\n\n    x = Math.max(0, x);\n    y = Math.max(0, y);\n\n    setPosition({ left: x, top: y, transform });\n  };\n\n  return (\n    <div\n      className={cls(\n        'lanting-tooltip-container',\n        `lanting-tooltip--${placement}`\n      )}\n      ref={ref}\n      style={{\n        transform: `translate(${position.left}px, ${position.top}px)`,\n      }}\n    >\n      <div\n        className={cls('lanting-tooltip-content', {\n          'lanting-tooltip-content--fadeOut': isClosing,\n        })}\n      >\n        {title}\n      </div>\n    </div>\n  );\n};\n\nexport default Tip;\n","import React, {\n  MouseEvent,\n  ReactElement,\n  ReactNode,\n  useEffect,\n  useRef,\n  useState,\n} from 'react';\nimport { createPortal } from 'react-dom';\nimport './style.scss';\nimport Tip, { Placement } from './Tip';\n\ninterface Props {\n  title?: ReactNode;\n  timeout?: number;\n  children: ReactElement;\n  placement?: Placement;\n}\n\nconst Tooltip: React.FC<Props> = ({\n  children,\n  title,\n  timeout = 0,\n  placement,\n}) => {\n  const timer = useRef<number>(0);\n  const [visible, setVisible] = useState(false);\n  const [rect, setRect] = useState<DOMRect>();\n  const [isClosing, setIsClosing] = useState(false);\n\n  useEffect(() => {}, []);\n\n  const handleEnter = (event: MouseEvent) => {\n    setIsClosing(false);\n\n    if (!visible) {\n      const target = event.currentTarget as HTMLElement;\n\n      setRect(target.getBoundingClientRect());\n\n      if (timeout > 0) {\n        timer.current = window.setTimeout(() => {\n          setVisible(true);\n        }, timeout);\n      } else {\n        setVisible(true);\n      }\n    }\n  };\n\n  const handleClose = () => {\n    setVisible(false);\n    setRect(undefined);\n  };\n\n  const handleLeave = (event: MouseEvent) => {\n    setIsClosing(true);\n\n    if (timer.current) {\n      clearTimeout(timer.current);\n    }\n  };\n\n  const child = React.cloneElement(children, {\n    onMouseEnter: handleEnter,\n    onMouseLeave: handleLeave,\n    onTouchStart: handleEnter,\n    onTouchEnd: handleLeave,\n  });\n\n  return (\n    <>\n      {child}\n      {visible &&\n        rect &&\n        createPortal(\n          <Tip\n            title={title}\n            rect={rect}\n            isClosing={isClosing}\n            placement={placement}\n            onClose={handleClose}\n          />,\n          document.body\n        )}\n    </>\n  );\n};\nexport default Tooltip;\n"],"names":["Tip","title","rect","placement","isClosing","onClose","ref","useRef","position","setPosition","useState","useEffect","oberver","entries","entry","calcPosition","handleClose","_a","width","left","top","height","coorX","coorY","w","h","x","y","transform","jsx","cls","Tooltip","children","timeout","timer","visible","setVisible","setRect","setIsClosing","handleEnter","event","target","handleLeave","child","React","jsxs","Fragment","createPortal"],"mappings":"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"}